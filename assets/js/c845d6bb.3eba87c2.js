"use strict";(self.webpackChunkblog_template=self.webpackChunkblog_template||[]).push([[764],{5742:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return o},metadata:function(){return p},assets:function(){return c},toc:function(){return d},default:function(){return u}});var a=n(7462),i=n(3366),r=(n(7294),n(3905)),l=["components"],s={slug:"tip_akka_gRPC_",title:"[Akka gRPC] Getting Started",authors:"jay",tags:["tip","akka gRPC"]},o=void 0,p={permalink:"/blog/tip_akka_gRPC_",source:"@site/blog/2021-11-04-Akka_gRPC/index.md",title:"[Akka gRPC] Getting Started",description:"Akka gRPC Plugin\uc744 \uc774\uc6a9\ud574 gRPC Sample Code\ub97c \ub9cc\ub4e4\uc5b4 \ubcf8\ub2e4.",date:"2021-11-04T00:00:00.000Z",formattedDate:"2021\ub144 11\uc6d4 4\uc77c",tags:[{label:"tip",permalink:"/blog/tags/tip"},{label:"akka gRPC",permalink:"/blog/tags/akka-g-rpc"}],readingTime:2.315,truncated:!1,authors:[{name:"Jay Kim",title:"\ucc45\uc784 \uc5f0\uad6c\uc6d0 / ELFiNOS\ud300",url:"https://github.com/jeongwan88",imageURL:"https://github.com/andes-noh.png",key:"jay"}],nextItem:{title:"[AkkaServerless] Getting Started",permalink:"/blog/tip_akkaserverless_start1"}},c={authorsImageUrls:[void 0]},d=[{value:"\uc608\uc81c\uc5d0\uc11c \uc0ac\uc6a9\ud55c \ubc84\uc804 \uc815\ubcf4",id:"\uc608\uc81c\uc5d0\uc11c-\uc0ac\uc6a9\ud55c-\ubc84\uc804-\uc815\ubcf4",children:[]},{value:"\ud504\ub85c\uc81d\ud2b8 \uc0dd\uc131",id:"\ud504\ub85c\uc81d\ud2b8-\uc0dd\uc131",children:[]},{value:"Plugin, Library \uc124\uc815",id:"plugin-library-\uc124\uc815",children:[]},{value:".proto \ud30c\uc77c \uc0dd\uc131",id:"proto-\ud30c\uc77c-\uc0dd\uc131",children:[]},{value:"\uae30\ub2a5 \uad6c\ud604",id:"\uae30\ub2a5-\uad6c\ud604",children:[]},{value:"Akka Http Server\uc640 \uc5f0\uacb0",id:"akka-http-server\uc640-\uc5f0\uacb0",children:[]},{value:"\ud14c\uc2a4\ud2b8",id:"\ud14c\uc2a4\ud2b8",children:[]}],k={toc:d};function u(e){var t=e.components,s=(0,i.Z)(e,l);return(0,r.kt)("wrapper",(0,a.Z)({},k,s,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Akka gRPC Plugin\uc744 \uc774\uc6a9\ud574 gRPC Sample Code\ub97c \ub9cc\ub4e4\uc5b4 \ubcf8\ub2e4."),(0,r.kt)("h2",{id:"\uc608\uc81c\uc5d0\uc11c-\uc0ac\uc6a9\ud55c-\ubc84\uc804-\uc815\ubcf4"},"\uc608\uc81c\uc5d0\uc11c \uc0ac\uc6a9\ud55c \ubc84\uc804 \uc815\ubcf4"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"JDK 11"),(0,r.kt)("li",{parentName:"ul"},"Scala 2.13.7"),(0,r.kt)("li",{parentName:"ul"},"sbt 1.3.9")),(0,r.kt)("h2",{id:"\ud504\ub85c\uc81d\ud2b8-\uc0dd\uc131"},"\ud504\ub85c\uc81d\ud2b8 \uc0dd\uc131"),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"\ubcf8 code\ub294 IntelliJ \uae30\uc900\uc5d0\uc11c \uc81c\uc791\ud558\uc600\uc2b5\ub2c8\ub2e4."))),(0,r.kt)("p",null,"File -> New -> Project \uc5d0\uc11c sbt \ud504\ub85c\uc81d\ud2b8\ub97c \uc0dd\uc131\ud55c\ub2e4."),(0,r.kt)("h2",{id:"plugin-library-\uc124\uc815"},"Plugin, Library \uc124\uc815"),(0,r.kt)("p",null,"project \ub514\ub809\ud1a0\ub9ac \uc548\uc5d0 ",(0,r.kt)("inlineCode",{parentName:"p"},"plugins.sbt")," \ud30c\uc77c\uc744 \uc0dd\uc131 \ud6c4 \uc544\ub798 \ucf54\ub4dc\ub97c \uc785\ub825\ud55c\ub2e4."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},'addSbtPlugin("com.lightbend.akka.grpc" % "sbt-akka-grpc" % "2.1.0")')),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"build.sbt")," \ud30c\uc77c\uc5d0 \uc544\ub798 \ucf54\ub4dc\ub97c \uc785\ub825\ud55c\ub2e4."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"enablePlugins(AkkaGrpcPlugin)")),(0,r.kt)("h2",{id:"proto-\ud30c\uc77c-\uc0dd\uc131"},".proto \ud30c\uc77c \uc0dd\uc131"),(0,r.kt)("p",null,"src/main/protobuf \uc5d0 test.proto \ud30c\uc77c\uc744 \uc0dd\uc131 \ud6c4 \uc544\ub798 \ucf54\ub4dc\ub97c \uc785\ub825\ud55c\ub2e4."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'syntax = "proto3";\n\npackage protobuf;\n\nmessage MachineRequest {\n    string ncId = 1;\n}\n\nmessage MachineResponse {\n    string message = 1;\n}\n\nservice ElfinService {\n  rpc GetMachineInfo(MachineRequest) returns (MachineResponse) {}\n}\n\n')),(0,r.kt)("p",null,"terminal\uc744 \ucf1c\uc11c \uc544\ub798 \ucee4\ub9e8\ub4dc\ub97c \uc785\ub825\ud558\uba74 \uad00\ub828 \ucf54\ub4dc\uac00 \uc790\ub3d9 \uc0dd\uc131 \ub41c\ub2e4."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"sbt compile\n")),(0,r.kt)("h2",{id:"\uae30\ub2a5-\uad6c\ud604"},"\uae30\ub2a5 \uad6c\ud604"),(0,r.kt)("p",null,"src/main/scala/ElfinServiceIm \ud30c\uc77c\uc744 \uc0dd\uc131 \ud6c4 \uc544\ub798 \ucf54\ub4dc\ub97c \uc785\ub825\ud55c\ub2e4."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'class ElfinServiceIm extends ElfinService {\n  override def getMachineInfo (in : MachineRequest) : Future[MachineResponse] = {\n    Future.successful(MachineResponse(s"NC${in.ncId} is RUNNING"))\n  }\n}\n\n')),(0,r.kt)("h2",{id:"akka-http-server\uc640-\uc5f0\uacb0"},"Akka Http Server\uc640 \uc5f0\uacb0"),(0,r.kt)("p",null,"src/main/scala/ElfinService \ud30c\uc77c\uc744 \uc0dd\uc131 \ud6c4 \uc544\ub798 \ucf54\ub4dc\ub97c \uc785\ub825\ud55c\ub2e4."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'import akka.actor.typed.ActorSystem\nimport akka.actor.typed.scaladsl.Behaviors\nimport akka.http.scaladsl.Http\nimport akka.http.scaladsl.model.{HttpRequest, HttpResponse}\nimport com.typesafe.config.ConfigFactory\nimport protobuf.ElfinServiceHandler\n\nimport scala.concurrent.{ExecutionContext, Future}\n\nobject ElfinServer extends App{\n  val config = ConfigFactory\n    .parseString("akka.http.server.preview.enable-http2 = on")\n    .withFallback(ConfigFactory.defaultApplication())\n\n  val system = ActorSystem[Nothing](Behaviors.empty, "elfinos_api", config)\n\n  new ElfinServer(system).run\n}\n\nclass ElfinServer(system: ActorSystem[_]){\n  def run : Future[Http.ServerBinding] = {\n    implicit val sys = system\n    implicit val ec : ExecutionContext = system.executionContext\n\n    val service : HttpRequest => Future[HttpResponse] =\n      ElfinServiceHandler(new ElfinServiceIm)\n\n    val bound : Future[Http.ServerBinding] = Http(system)\n      .newServerAt("localhost", 8080)\n      .bind(service)\n\n    bound.foreach{\n      binding => println(s"gRPC server bound to : ${binding.localAddress}")\n    }\n    bound\n  }\n}\n')),(0,r.kt)("h2",{id:"\ud14c\uc2a4\ud2b8"},"\ud14c\uc2a4\ud2b8"),(0,r.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"\ubcf8 \ud14c\uc2a4\ud2b8\ub294 insomnia \ub85c \uc9c4\ud589\ud558\uc600\uc2b5\ub2c8\ub2e4."))),(0,r.kt)("p",null,"New Request \uc5d0\uc11c \uc544\ub798\uc640 \uac19\uc774 \uc124\uc815\ud55c\ub2e4."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(6658).Z})),(0,r.kt)("p",null,"Add Proto File \uc744 \ud074\ub9ad \ud6c4 \uc704\uc5d0\uc11c \ub9cc\ub4e0 test.proto \ud30c\uc77c\uc744 \uc120\ud0dd\ud558\uace0 save\ub97c \ud074\ub9ad\ud55c\ub2e4."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(285).Z})),(0,r.kt)("p",null,"IP\uc640 Port \uc124\uc815 \ud6c4 Select Method \uc5d0\uc11c /ElfinService/GetMachineIno \ub97c \uc120\ud0dd\ud55c\ub2e4."),(0,r.kt)("p",null,"Body\uc5d0 \ub2e4\uc74c\uacfc \uac19\uc774 \uc785\ub825 \ud6c4 Send\ub97c \ud074\ub9ad\ud558\uace0 Response \uac12\uc744 \ud655\uc778\ud55c\ub2e4."),(0,r.kt)("p",null,(0,r.kt)("img",{src:n(9854).Z})))}u.isMDXComponent=!0},6658:function(e,t,n){t.Z=n.p+"assets/images/grpc-ca29d65c0a730ff52783d4ee254b9b77.png"},9854:function(e,t,n){t.Z=n.p+"assets/images/rtn-489b8a62c252337060ec41cf6e83109c.png"},285:function(e,t,n){t.Z=n.p+"assets/images/save-e2fd0bdc03572214b3614afb52dcccc0.png"}}]);